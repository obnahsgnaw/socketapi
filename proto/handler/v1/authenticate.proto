syntax = "proto3";
package handler.v1;

message AuthenticateRequest {
  string gateway = 1; // 网关地址
  int64 fd = 2; // fd
  string type = 3; // 认证类型
  string id = 4;   // 认证id
  string secret = 5; // 认证密钥 RSA.Encrypt(AES.Key+timestamp-10)
}

message AuthenticateResponse {
  bytes key = 1; // AES.key
  map<string, string> ext = 2; // 扩展信息
  message User{
    int64 id = 1;
    string name = 2;
    map<string, string> attrs = 3;
  }
  User user = 3; // 用户信息
}